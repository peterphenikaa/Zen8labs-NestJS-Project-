doctype html
html
  head
    title Đăng nhập
    style.
      body { font-family: Arial, sans-serif; background: #f4f4f4; }
      .container { max-width: 400px; margin: 60px auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
      h2 { text-align: center; }
      input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; }
      button { width: 100%; padding: 10px; background: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
      button:hover { background: #0056b3; }
      .error { color: red; text-align: center; }
  body
    .container
      // small register toggle at top-right
      .top-toggle(style='display:flex; justify-content:flex-end;')
        a#showRegister(style='font-size:12px; cursor:pointer; color:#007bff; text-decoration:none;') Đăng ký

      h2 Đăng nhập
      if error
      
        .error= error
      form(action='/v1/auth/login', method='POST', id='loginForm')
        input(type='email', name='email', placeholder='Email', required=true)
        input(type='password', name='password', placeholder='Password', required=true)
        button(type='submit') Đăng nhập

      // registration section hidden by default
      #registerSection(style='display:none; margin-top:16px;')
        hr
        h3 Đăng ký tài khoản
        #registerMsg
        form(id='registerForm')
          input(type='email', id='regEmail', placeholder='Email', required=true)
          input(type='password', id='regPassword', placeholder='Password', required=true)
          input(type='text', id='regName', placeholder='Name (optional)')
          button(type='button', id='btnRegister') Đăng ký

      script.
        (function(){
          const btn = document.getElementById('btnRegister');
          const msg = document.getElementById('registerMsg');
          const toggle = document.getElementById('showRegister');
          const section = document.getElementById('registerSection');

          // Toggle visibility of registration section
          toggle.addEventListener('click', function(){
            if(section.style.display === 'none' || !section.style.display){
              section.style.display = 'block';
              section.scrollIntoView({ behavior: 'smooth' });
            } else {
              section.style.display = 'none';
            }
          });

          btn.addEventListener('click', async function(){
            msg.textContent = '';
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const name = document.getElementById('regName').value.trim();
            if(!email || !password){ msg.style.color = 'red'; msg.textContent = 'Email và mật khẩu là bắt buộc'; return; }
            try{
              const res = await fetch('/v1/auth/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password, name })
              });
              const json = await res.json();
              if(res.ok && json && json.status !== false){
                msg.style.color = 'green';
                msg.textContent = 'Đăng ký thành công, quay về đăng nhập.';
              } else {
                msg.style.color = 'red';
                msg.textContent = (json && json.message) ? json.message : 'Đăng ký thất bại';
              }
            } catch(err){
              msg.style.color = 'red';
              msg.textContent = 'Lỗi mạng';
            }
          });
        })();




  